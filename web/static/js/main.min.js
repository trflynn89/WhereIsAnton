function getLocations(){$(".hamburger").children().addClass("loading"),$.get("/locations/",function(e){addLocations(e.locations),$(".hamburger").children().removeClass("loading")})}function getDrunks(){$(".hamburger").children().addClass("loading"),$.get("/drunk/",function(e){showDrunks(e.drunks),$(".hamburger").children().removeClass("loading")})}function createDrunk(e,t){$.post("/drunk/",{time:e,drunk:t})}function timeComparator(e,t){return e.time==t.time?0:e.time<t.time?1:e.time>t.time?-1:void 0}function addLocations(e){if(0!=e.length)if(e.sort(timeComparator),clearMarkers(),void 0!==s_path&&null!=s_path&&(s_path.setMap(null),s_path=null),s_showAll){for(var t=new google.maps.LatLngBounds,n=[],a=0;a<e.length;++a){var o=addMarker(e[a]);t.extend(o),n.push(o)}s_path=new google.maps.Polyline({path:n,geodesic:!0,strokeColor:"#ff0000",stokeOpacity:.85,strokeWeight:2}),s_map.fitBounds(t),s_path.setMap(s_map)}else{var r=e[0].latitude,s=e[0].longitude;s_map.setCenter(new google.maps.LatLng(r,s)),s_map.setZoom(8),addMarker(e[0])}}function showDrunks(e){if(0==e.length)return void Lobibox.alert("error",{title:"Nope!",msg:"Anton has never been drunk :("});e.sort(timeComparator);var t=e[0].drunk,n=new Date(e[0].time).getTime(),a=(new Date).getTime(),o=Math.ceil((a-n)/MILLIS_PER_HOUR);t&&o>s_drunkTimeout&&(sTime=n+s_drunkTimeout*MILLIS_PER_HOUR,createDrunk(sTime,!1),o=Math.ceil((a-sTime)/MILLIS_PER_HOUR),t=!1);var r=t?"Yes!":"Nope!",s=t?" drunk ":" sober ",i=1==o?" hour":" hours",l=t?" :)":" :(",u=t?"info":"error",m=" Anton has been"+s+"for "+o+i+l;Lobibox.alert(u,{title:r,msg:m})}function addMarker(e){var t=new google.maps.LatLng(e.latitude,e.longitude),n=new google.maps.Marker({position:t,map:s_map});return labelMarker(n,e.address),s_markers.push(n),t}function clearMarkers(){for(var e=0;e<s_markers.length;++e)s_markers[e].setMap(null);s_markers=[]}function labelMarker(e,t){var n=new google.maps.InfoWindow({content:t});n.open(e.getMap(),e),e.addListener("click",function(){n.open(e.getMap(),e)})}function handleNavOption(e){s_showAll=e,getLocations()}function showDrunkStatus(){getDrunks()}var s_map,s_path,s_markers=[],s_showAll=!1,s_drunkTimeout=10,MILLIS_PER_HOUR=36e5;$(document).ready(function(e){s_map=new google.maps.Map(document.getElementById("map"),{disableDefaultUI:!0,center:{lat:0,lng:0},zoom:2}),getLocations()});
